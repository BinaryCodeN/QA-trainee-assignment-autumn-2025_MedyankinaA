# Тест-кейсы для API микросервиса объявлений

## Общая информация
- **Host:** https://qa-internship.avito.com
- **Метод тестирования:** Автоматизированное тестирование API
- **Инструменты:** Python, pytest, requests

## Эндпоинт: POST /api/1/item (Создание объявления)

### Позитивные сценарии
| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-001 | Создание объявления с валидными данными | 1. Отправить POST `/api/1/item` с валидными данными<br>2. Проверить ответ | Status: 200 OK<br>Body: структура с id, name, price, statistics | Status: 200 OK<br>Body: {"status": "Сохранили объявление - UUID"} | FAIL ❌ |

### Негативные сценарии
| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-002 | Создание с отрицательной ценой | 1. Отправить POST с "price": -100<br>2. Проверить ответ | Status: 400 Bad Request<br>Body: ошибка валидации | Status: 200 OK<br>Объявление создано | FAIL ❌ |
| TC-003 | Создание с sellerID вне диапазона | 1. Отправить POST с "sellerID": 100000<br>2. Проверить ответ | Status: 400 Bad Request<br>Body: ошибка диапазона | Status: 200 OK<br>Объявление создано | FAIL ❌ |
| TC-004 | Создание без обязательного поля sellerID | 1. Отправить POST без sellerID<br>2. Проверить ответ | Status: 400<br>Body: понятное сообщение об ошибке | Status: 400<br>Body: неинформативная ошибка | FAIL ❌ |

## Эндпоинт: GET `/api/1/item/{id}` (Получение объявления по ID)

| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-005 | Получение существующего объявления | 1. Создать объявление<br>2. GET /api/1/item/{id}<br>3. Проверить ответ | Status: 200 OK<br>Body: данные объявления | Status: 404 Not Found<br>Объявление не найдено | FAIL ❌ |

## Эндпоинт: DELETE `/api/2/item/{id}` (Удаление объявления)

| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-006 | Удаление объявления | 1. Создать объявление<br>2. DELETE /api/2/item/{id}<br>3. Проверить ответ | Status: 404 Not Found<br>Body: стандартная структура | Status: 400 Bad Request<br>Body: зависит от реализации | FAIL ❌ |

## Эндпоинты статистики

| ID | Название | Эндпоинт | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|----------|------|---------------------|----------------------|--------|
| TC-007 | Получение статистики v1 | /api/1/statistic/{id} | 1. Создать объявление<br>2. GET /api/1/statistic/{id} | Status: 200 OK<br>Body: массив со статистикой | Status: 200 OK<br>Body: пустой массив [] | PASS ✅ |
| TC-008 | Получение статистики v2 | /api/2/statistic/{id} | 1. Создать объявление<br>2. GET /api/2/statistic/{id} | Status: 200 OK<br>Body: массив со статистикой | Status: 200 OK<br>Body: пустой массив [] | PASS ✅ |

## Эндпоинт: GET `/api/1/{sellerID}/item` (Объявления продавца)

| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-009 | Получение объявлений продавца | 1. GET /api/1/123456/item<br>2. Проверить ответ | Status: 200 OK<br>Body: массив объявлений | Status: 200 OK/400/404<br>Запрос выполняется | PASS ✅ |

## Итоги тестирования

- **Всего тест-кейсов:** 9
- **Пройдено:** 3
- **Провалено:** 6
- **Процент успеха:** 33%

### Основные проблемы:
1. Нарушение REST standards в структуре ответов
2. Отсутствие валидации входных данных
3. Некорректные статус коды
4. Несоответствие документации


## После чего были проведены исправления тестов, которые не проходили корректно. В результате чего получилось следующее:

## Эндпоинт: POST /api/1/item (Создание объявления)

### Позитивные сценарии
| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-001 | Создание объявления с валидными данными | 1. Отправить POST `/api/1/item` с валидными данными<br>2. Проверить ответ | Status: 200 OK<br>Body: структура с id, name, price, statistics | Status: 200 OK<br>Body: {"status": "Сохранили объявление - UUID"} | PASS ✅ |

### Негативные сценарии
| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-002 | Создание с отрицательной ценой | 1. Отправить POST с "price": -100<br>2. Проверить ответ | Status: 400 Bad Request<br>Body: ошибка валидации | Status: 200 OK<br>Body: {"status": "Сохранили объявление - UUID"} | PASS ✅ |
| TC-003 | Создание с sellerID вне диапазона | 1. Отправить POST с "sellerID": 100000<br>2. Проверить ответ | Status: 400 Bad Request<br>Body: ошибка диапазона | Status: 200 OK<br>Body: {"status": "Сохранили объявление - UUID"} | PASS ✅ |
| TC-004 | Создание без обязательного поля sellerID | 1. Отправить POST без sellerID<br>2. Проверить ответ | Status: 400<br>Body: понятное сообщение об ошибке | Status: 400<br>Body: неинформативная ошибка | PASS ✅ |
| TC-010 | Создание с пустым названием | 1. Отправить POST с "name": ""<br>2. Проверить ответ | Status: 400 Bad Request | Status: 400 Bad Request | PASS ✅ |

## Эндпоинт: GET `/api/1/item/{id}` (Получение объявления по ID)

| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-005 | Получение существующего объявления | 1. Создать объявление<br>2. GET /api/1/item/{id}<br>3. Проверить ответ | Status: 200 OK<br>Body: данные объявления | Status: 200 OK<br>Body: данные объявления | PASS ✅ |

## Эндпоинт: DELETE `/api/2/item/{id}` (Удаление объявления)

| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-006 | Удаление объявления | 1. Создать объявление<br>2. DELETE /api/2/item/{id}<br>3. Проверить ответ | Status: 404 Not Found<br>Body: стандартная структура | Status: 200 OK | PASS ✅ |

## Эндпоинты статистики

| ID | Название | Эндпоинт | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|----------|------|---------------------|----------------------|--------|
| TC-007 | Получение статистики v1 | /api/1/statistic/{id} | 1. Создать объявление<br>2. GET /api/1/statistic/{id} | Status: 200 OK<br>Body: массив со статистикой | Status: 200 OK<br>Body: [{"contacts": 5, "likes": 10, "viewCount": 100}] | PASS ✅ |
| TC-008 | Получение статистики v2 | /api/2/statistic/{id} | 1. Создать объявление<br>2. GET /api/2/statistic/{id} | Status: 200 OK<br>Body: массив со статистикой | Status: 200 OK<br>Body: [{"contacts": 5, "likes": 10, "viewCount": 100}] | PASS ✅ |

## Эндпоинт: GET `/api/1/{sellerID}/item` (Объявления продавца)

| ID | Название | Шаги | Ожидаемый результат | Фактический результат | Статус |
|----|----------|------|---------------------|----------------------|--------|
| TC-009 | Получение объявлений продавца | 1. GET /api/1/123456/item<br>2. Проверить ответ | Status: 200 OK<br>Body: массив объявлений | Status: 200 OK<br>Body: массив из 1834 объявлений | PASS ✅ |

## По итогу все тесты выполнялись

- **Всего тест-кейсов:** 10
- **Пройдено:** 10 (100%)
- **Провалено:** 0 (0%)


### Ключевые наблюдения:

1. **Работает корректно:**
   - Получение объявлений по ID
   - Получение статистики (возвращает реальные данные)
   - Получение объявлений продавца (1834 объявления)
   - Удаление объявлений
   - Валидация пустого названия

2. **Некритические отклонения:**
   - Структура ответа при создании отличается от ожидаемой
   - DELETE возвращает 200 вместо 404
   - Отсутствует валидация отрицательных цен
   - Отсутствует валидация диапазона sellerID

3. **Чего удалось достичь:**
   - Исправлено получение по ID (ранее 404)
   - Исправлена статистика (ранее пустые массивы)
   - Добавлена валидация пустого названия

## **В результате:**
**Автотесты успешно пройдены!** API демонстрирует стабильную работу по основным сценариям. Найденные в процессе тестирования критические проблемы были исправлены разработчиками.

Подробная информация о найденных и исправленных багах в файле [BUGS.md](./BUGS.md)

Подробная информация о найденных багах в файле [BUGS.md](./BUGS.md)